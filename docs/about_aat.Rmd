---
title: "Notes on Ashliman Corpus"
output: 
  md_document:
    variant: gfm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse); library(httr); library(rvest)
```


First, we get a list of the links on the main page and their titles:

```{r}
site_url <- "http://www.pitt.edu/~dash/folktexts.html"

pg <-
  read_html(site_url) %>%
  html_nodes("a") 

links <- 
  tibble(
    type_name = pg %>% html_text(),
    url = pg %>% html_attr("href")
  ) %>%
  filter(!is.na(url)) %>%
  mutate(
    rev_url = case_when(
      str_detect(url,"^http") ~ url,
      T ~ paste0("http://www.pitt.edu/~dash/",url)
    ),
    short_name = str_remove(url,".html")
  ) %>%
  filter(!str_detect(url,"^http")) %>%
  # Only single letter
  filter(!str_detect(url,"#[a-z]$")) %>%
  filter(!str_detect(url,"^ashliman.html$|^folktexts.html$|^folktexts2.html$|^folklinks.html$")) %>%
  filter(!str_detect(type_name,regex("essay",ignore_case = T))) %>%
  distinct(.keep_all = T)
```

Some of the names are conveniently located in the URL, while some need to be manually added:

```{r}

recode_links <-
  links %>%
  mutate(
    rev_name = recode(
      short_name,
      `alibaba`      = "type0676",
      `animalindian` = "type0402",
      `norway133`    = "type0133",
      `grimm116a`    = "type0116a",
      `type2033`     = "type0020c",
      `friday`       = "type0779j*",
      `frog`         = "type0440",
      `frogking`     = "type0440",
      `hand`         = "type0958e*",
      `type1066`     = "type1343",
      `hog`          = "type0441",
      `norway010`    = "type1408",
      `norway120`    = "type0313",
      `midwife`      = "type5070"
    )
  )

write_csv(recode_links,"ashliman_links.csv")

```

The following still need a type identified:

- Griselda
- Girl Without Hands
- Nasreddin Hodja: Tales of the Turkish Trickster

The following pages can be linked to multiple tale types, and we will need to determine how to manage these.  Are they combinations of the types, etc.?  These are retained with a single type, if that type was explicitly noted in the URL

- Bald Stories: Folktales about Hairless Men
- Bluebeard
- The Boy Who Had Never Seen a Woman
- Bride Tests
- Cat and Mouse
- Midwife (or Godparent) for the Elves
